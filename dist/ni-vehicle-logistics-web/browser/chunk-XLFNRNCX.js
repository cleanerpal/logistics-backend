import"./chunk-MS4AQ6UA.js";import{b as re,c as oe}from"./chunk-LDLE5TDT.js";import{a as fe,b as ue}from"./chunk-DJMXPRNS.js";import{d as pe}from"./chunk-U5UIMM6O.js";import"./chunk-PP7BOOB7.js";import{a as ie}from"./chunk-FL7UC7QU.js";import"./chunk-DQFV6XNM.js";import{a as J,b as K,c as Q,f as W,h as X}from"./chunk-OFY7VGJP.js";import{b as Z,c as ee,i as te}from"./chunk-P7ITNQJW.js";import{a as ce,b as se}from"./chunk-HDC6EVXZ.js";import{b as de}from"./chunk-Q2NIOR5G.js";import{E as ne,H as ae,I as me,J as le,b as A,d as f,g as j,h as G,l as Y,m as z,o as L,q as U,u as $,w as H}from"./chunk-E6Y7ME2X.js";import"./chunk-ZO4V6NUC.js";import{a as P,c as k,g as T}from"./chunk-4PPYA6ZN.js";import{ea as y,ga as N,i as V,j as O,ja as D,ka as B,ma as F,o as w,oa as q,wa as R}from"./chunk-3O2P3FIP.js";import{Cb as l,Lb as o,Mb as e,Nb as p,Rb as S,Vb as M,Wb as h,db as m,fc as n,hc as g,ib as u,pa as x,pb as b,qa as C,vb as d}from"./chunk-NXWLSP6D.js";import{g as v}from"./chunk-RA2WU32H.js";function ge(t,i){t&1&&(o(0,"div",5),p(1,"mat-spinner",6),e())}function _e(t,i){t&1&&(o(0,"mat-error"),n(1," Registration is required "),e())}function ve(t,i){t&1&&(o(0,"mat-error"),n(1," Year is required "),e())}function xe(t,i){t&1&&(o(0,"mat-error"),n(1," Please enter a valid year "),e())}function Ce(t,i){t&1&&(o(0,"mat-error"),n(1," Make is required "),e())}function Me(t,i){t&1&&(o(0,"mat-error"),n(1," Model is required "),e())}function ye(t,i){if(t&1&&(o(0,"mat-option",24),n(1),e()),t&2){let r=i.$implicit;l("value",r),m(),g(" ",r," ")}}function Fe(t,i){t&1&&(o(0,"mat-error"),n(1," Vehicle type is required "),e())}function Ee(t,i){if(t&1&&(o(0,"mat-option",24),n(1),e()),t&2){let r=i.$implicit;l("value",r),m(),g(" ",r," ")}}function Ie(t,i){if(t&1&&(o(0,"div",25)(1,"mat-form-field",10)(2,"mat-label"),n(3,"Status"),e(),o(4,"mat-select",26),d(5,Ee,2,2,"mat-option",17),e()()()),t&2){let r=h(2);m(5),l("ngForOf",r.vehicleStatusOptions)}}function be(t,i){t&1&&p(0,"mat-spinner",27)}function Se(t,i){if(t&1&&(o(0,"span")(1,"mat-icon"),n(2,"save"),e(),n(3),e()),t&2){let r=h(2);m(3),g(" ",r.isEditMode?"Update":"Create"," Vehicle ")}}function Ve(t,i){if(t&1){let r=S();o(0,"form",7),M("ngSubmit",function(){x(r);let a=h();return C(a.onSubmit())}),o(1,"mat-card",8)(2,"mat-card-header")(3,"mat-card-title"),n(4,"Vehicle Details"),e()(),o(5,"mat-card-content")(6,"div",9)(7,"mat-form-field",10)(8,"mat-label"),n(9,"Registration"),e(),p(10,"input",11),d(11,_e,2,0,"mat-error",12),e(),o(12,"mat-form-field",10)(13,"mat-label"),n(14,"Year"),e(),p(15,"input",13),d(16,ve,2,0,"mat-error",12)(17,xe,2,0,"mat-error",12),e()(),o(18,"div",9)(19,"mat-form-field",10)(20,"mat-label"),n(21,"Make"),e(),p(22,"input",14),d(23,Ce,2,0,"mat-error",12),e(),o(24,"mat-form-field",10)(25,"mat-label"),n(26,"Model"),e(),p(27,"input",15),d(28,Me,2,0,"mat-error",12),e()(),o(29,"div",9)(30,"mat-form-field",10)(31,"mat-label"),n(32,"Type"),e(),o(33,"mat-select",16),d(34,ye,2,2,"mat-option",17),e(),d(35,Fe,2,0,"mat-error",12),e(),o(36,"mat-form-field",10)(37,"mat-label"),n(38,"Current Location"),e(),p(39,"input",18),e()(),d(40,Ie,6,1,"div",19),e()(),o(41,"div",20)(42,"button",21),M("click",function(){x(r);let a=h();return C(a.onCancel())}),o(43,"mat-icon"),n(44,"cancel"),e(),n(45," Cancel "),e(),o(46,"button",22),d(47,be,1,0,"mat-spinner",23)(48,Se,4,1,"span",12),e()()()}if(t&2){let r,c,a,_,E,I,s=h();l("formGroup",s.vehicleForm),m(11),l("ngIf",(r=s.vehicleForm.get("registration"))==null?null:r.hasError("required")),m(5),l("ngIf",(c=s.vehicleForm.get("year"))==null?null:c.hasError("required")),m(),l("ngIf",((a=s.vehicleForm.get("year"))==null?null:a.hasError("min"))||((a=s.vehicleForm.get("year"))==null?null:a.hasError("max"))),m(6),l("ngIf",(_=s.vehicleForm.get("make"))==null?null:_.hasError("required")),m(5),l("ngIf",(E=s.vehicleForm.get("model"))==null?null:E.hasError("required")),m(6),l("ngForOf",s.vehicleTypes),m(),l("ngIf",(I=s.vehicleForm.get("type"))==null?null:I.hasError("required")),m(5),l("ngIf",s.isEditMode),m(6),l("disabled",s.saving),m(),l("ngIf",s.saving),m(),l("ngIf",!s.saving)}}var he=class t{constructor(i,r,c,a,_){this.formBuilder=i;this.firestore=r;this.route=c;this.router=a;this.snackBar=_;this.vehicleForm=this.formBuilder.group({registration:["",[f.required]],make:["",[f.required]],model:["",[f.required]],type:["",[f.required]],year:[new Date().getFullYear(),[f.required,f.min(1900),f.max(new Date().getFullYear()+1)]],location:[""],status:["Available"]})}vehicleForm;isEditMode=!1;vehicleId=null;loading=!0;saving=!1;vehicleTypes=["Car","Van","Truck","Motorcycle"];vehicleStatusOptions=["Available","In Use","Maintenance","Out of Service"];ngOnInit(){this.route.paramMap.subscribe(i=>{this.vehicleId=i.get("id"),this.vehicleId?(this.isEditMode=!0,this.loadVehicleData(this.vehicleId)):this.loading=!1})}loadVehicleData(i){return v(this,null,function*(){try{let r=F(this.firestore,"Vehicles",i),c=yield q(r);if(c.exists()){let a=c.data();this.vehicleForm.patchValue({registration:a.registration||"",make:a.make||"",model:a.model||"",type:a.type||"",year:a.year||new Date().getFullYear(),location:a.location||"",status:a.status||"Available"}),this.loading=!1}else this.snackBar.open("Vehicle not found.","Close",{duration:5e3}),this.router.navigate(["/vehicles"])}catch(r){console.error("Error loading vehicle:",r),this.snackBar.open("Error loading vehicle data.","Close",{duration:5e3}),this.loading=!1}})}onSubmit(){return v(this,null,function*(){if(this.vehicleForm.invalid){Object.keys(this.vehicleForm.controls).forEach(i=>{this.vehicleForm.get(i)?.markAsTouched()});return}this.saving=!0;try{let i=this.vehicleForm.value,r={registration:i.registration,make:i.make,model:i.model,type:i.type,year:i.year,location:i.location,status:i.status,updatedAt:y.now()};if(this.isEditMode||Object.assign(r,{createdAt:y.now()}),this.isEditMode&&this.vehicleId){let c=F(this.firestore,"Vehicles",this.vehicleId);yield R(c,r),this.snackBar.open("Vehicle updated successfully","Close",{duration:3e3})}else{let c=B(this.firestore,"Vehicles"),a=yield D(c,r);this.snackBar.open("Vehicle created successfully","Close",{duration:3e3}),this.router.navigate(["/vehicles/edit",a.id])}}catch(i){console.error("Error saving vehicle:",i),this.snackBar.open("Error saving vehicle. Please try again.","Close",{duration:5e3})}finally{this.saving=!1}})}onCancel(){this.router.navigate(["/vehicles"])}static \u0275fac=function(r){return new(r||t)(u($),u(N),u(P),u(k),u(de))};static \u0275cmp=b({type:t,selectors:[["app-vehicle-form"]],decls:6,vars:3,consts:[[1,"vehicle-form-container"],[1,"page-header"],[1,"page-title"],["class","loading-container",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"loading-container"],["diameter","50"],[3,"ngSubmit","formGroup"],[1,"form-card"],[1,"form-row","row-split"],["appearance","outline"],["matInput","","formControlName","registration"],[4,"ngIf"],["matInput","","formControlName","year","type","number"],["matInput","","formControlName","make"],["matInput","","formControlName","model"],["formControlName","type"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","location"],["class","form-row",4,"ngIf"],[1,"form-actions"],["type","button","mat-stroked-button","",3,"click"],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["diameter","20",4,"ngIf"],[3,"value"],[1,"form-row"],["formControlName","status"],["diameter","20"]],template:function(r,c){r&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),n(3),e()(),d(4,ge,2,0,"div",3)(5,Ve,49,12,"form",4),e()),r&2&&(m(3),g(" ",c.isEditMode?"Edit Vehicle":"Create New Vehicle"," "),m(),l("ngIf",c.loading),m(),l("ngIf",!c.loading))},dependencies:[w,V,O,H,Y,A,z,j,G,L,U,ie,te,Z,ee,oe,re,ue,fe,pe,ae,ne,le,me,X,J,Q,W,K,se,ce,T],styles:[".vehicle-form-container[_ngcontent-%COMP%]{padding:20px;background-color:#f5f5f5;min-height:100%}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}}.page-title[_ngcontent-%COMP%]{font-size:24px;font-weight:500;color:#4a3c31;margin:0}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:200px}.form-card[_ngcontent-%COMP%]{margin-bottom:24px;border-radius:8px;box-shadow:0 2px 10px #0000001a}.form-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{padding:16px 16px 0}.form-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]   .mat-mdc-card-title[_ngcontent-%COMP%]{color:#4a3c31;font-size:18px;margin-bottom:8px}.form-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{padding:16px}.form-row[_ngcontent-%COMP%]{margin-bottom:16px;width:100%}.form-row.row-split[_ngcontent-%COMP%]{display:flex;gap:16px}.form-row.row-split[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{flex:1}@media (max-width: 768px){.form-row.row-split[_ngcontent-%COMP%]{flex-direction:column;gap:0}}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:16px;margin-top:24px;margin-bottom:40px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px}@media (max-width: 576px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}"]})};export{he as VehicleFormComponent};
