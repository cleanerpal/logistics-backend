import{a as Rt}from"./chunk-3LXRQY3K.js";import{a as Tt,b as Vt}from"./chunk-BN3GLMV7.js";import{c as Dt,d as Ot,e as Pt,f as wt,g as yt,h as Et,i as It}from"./chunk-ZJA6YHPC.js";import{a as ht,c as xt,d as bt,e as Mt,f as St,h as ue}from"./chunk-RDAIYJSK.js";import{b as Ft,c as kt,d as Ht}from"./chunk-DWEM3L4R.js";import"./chunk-ESJIWLK4.js";import"./chunk-F5X5MWHG.js";import{a as de,b as We}from"./chunk-VWFB2ZCV.js";import{a as Xe,b as Ye}from"./chunk-6ZM5HFJH.js";import{a as pt,d as ut,e as gt,f as vt,g as ft,h as _t,i as Ct}from"./chunk-PQIIHW7R.js";import"./chunk-GW6WOXIL.js";import"./chunk-MS4AQ6UA.js";import{b as ne,c as ie}from"./chunk-LDLE5TDT.js";import{a as Ue,b as ze}from"./chunk-DJMXPRNS.js";import{d as Ge}from"./chunk-U5UIMM6O.js";import"./chunk-PP7BOOB7.js";import{a as te}from"./chunk-FL7UC7QU.js";import{a as pe,b as Ke,c as Ze}from"./chunk-RGR4672A.js";import{a as et,b as tt,c as nt,d as it,e as ot,f as rt,g as at,h as lt,i as mt,j as st,k as ct,l as dt}from"./chunk-HITQB7VJ.js";import"./chunk-DQFV6XNM.js";import{a as Le,c as Be,h as qe}from"./chunk-OFY7VGJP.js";import{b as Z,c as Je,f as Ae,i as ee}from"./chunk-P7ITNQJW.js";import{a as me,b as $e}from"./chunk-HDC6EVXZ.js";import{b as se,c as ce}from"./chunk-Q2NIOR5G.js";import{C as Qe,E as oe,H as re,I as ae,J as le,b as $,d as D,g as G,h as U,i as Ce,k as z,l as X,m as Ve,o as Y,p as Re,q as W,s as Ne,u as je,w as K}from"./chunk-E6Y7ME2X.js";import"./chunk-ZO4V6NUC.js";import{a as Q}from"./chunk-M4BJXN77.js";import{c as Fe,g as ke}from"./chunk-4PPYA6ZN.js";import{ea as He,fa as fe,ga as A,h as ye,i as Ee,j as q,ja as Te,ka as V,n as Ie,o as J,ta as _e,ua as R,xa as N}from"./chunk-3O2P3FIP.js";import{$b as k,Bb as be,Cb as c,Lb as a,Mb as o,Nb as f,Ob as O,Pb as P,Rb as w,Vb as M,Wb as p,Zb as Me,ac as H,bb as xe,bc as T,db as m,ec as Se,fc as l,gc as h,hc as y,ib as x,ic as De,pa as g,pb as B,pc as Oe,qa as v,tc as Pe,uc as we,vb as d}from"./chunk-NXWLSP6D.js";import{a as I,b as F,g as ve}from"./chunk-RA2WU32H.js";var Yt=["fromSignatureCanvas"],Wt=["toSignatureCanvas"];function Kt(i,t){i&1&&l(0,"Handover Details")}function Zt(i,t){i&1&&(a(0,"div",31),f(1,"mat-spinner",32),a(2,"span"),l(3,"Loading active jobs..."),o()())}function en(i,t){if(i&1&&(a(0,"mat-option",46),l(1),o()),i&2){let e=t.$implicit;c("value",e.id),m(),De(" ",e.jobId," - ",e.vehicleId," ")}}function tn(i,t){i&1&&(a(0,"mat-error"),l(1," Job is required "),o())}function nn(i,t){i&1&&(a(0,"mat-error"),l(1," Odometer reading is required "),o())}function on(i,t){i&1&&(a(0,"mat-error"),l(1," Odometer reading must be positive "),o())}function rn(i,t){i&1&&(a(0,"mat-error"),l(1," Odometer reading must be a number "),o())}function an(i,t){i&1&&(a(0,"mat-error"),l(1," Location is required "),o())}function ln(i,t){if(i&1&&(a(0,"mat-option",46),l(1),o()),i&2){let e=t.$implicit;c("value",e.value),m(),y(" ",e.label," ")}}function mn(i,t){i&1&&(a(0,"mat-error"),l(1," Reason is required "),o())}function sn(i,t){i&1&&(a(0,"mat-error"),l(1," Custom reason is required "),o())}function cn(i,t){if(i&1&&(a(0,"div",23)(1,"mat-form-field",24)(2,"mat-label"),l(3,"Custom Reason"),o(),f(4,"textarea",47),d(5,sn,2,0,"mat-error",30),o()()),i&2){let e,n=p(2);m(5),c("ngIf",(e=n.detailsForm.get("customReason"))==null?null:e.hasError("required"))}}function dn(i,t){if(i&1&&(a(0,"form",33)(1,"div",23)(2,"mat-form-field",24)(3,"mat-label"),l(4,"Select Job"),o(),a(5,"mat-select",34),d(6,en,2,3,"mat-option",35),o(),d(7,tn,2,0,"mat-error",30),o()(),a(8,"div",36)(9,"mat-form-field",37)(10,"mat-label"),l(11,"Vehicle"),o(),f(12,"input",38),o(),a(13,"mat-form-field",37)(14,"mat-label"),l(15,"Current Driver"),o(),f(16,"input",39),o()(),a(17,"div",36)(18,"mat-form-field",37)(19,"mat-label"),l(20,"Odometer"),o(),f(21,"input",40),d(22,nn,2,0,"mat-error",30)(23,on,2,0,"mat-error",30)(24,rn,2,0,"mat-error",30),o(),a(25,"mat-form-field",37)(26,"mat-label"),l(27,"Location"),o(),f(28,"input",41),d(29,an,2,0,"mat-error",30),o()(),a(30,"div",23)(31,"mat-form-field",24)(32,"mat-label"),l(33,"Reason for Handover"),o(),a(34,"mat-select",42),d(35,ln,2,2,"mat-option",35),o(),d(36,mn,2,0,"mat-error",30),o()(),d(37,cn,6,1,"div",43),a(38,"div",26)(39,"button",44),l(40,"Cancel"),o(),a(41,"button",45),l(42," Next "),o()()()),i&2){let e,n,r,s,u,_,S,C=p();c("formGroup",C.detailsForm),m(6),c("ngForOf",C.activeJobs),m(),c("ngIf",(e=C.detailsForm.get("jobId"))==null?null:e.hasError("required")),m(15),c("ngIf",(n=C.detailsForm.get("odometer"))==null?null:n.hasError("required")),m(),c("ngIf",(r=C.detailsForm.get("odometer"))==null?null:r.hasError("min")),m(),c("ngIf",(s=C.detailsForm.get("odometer"))==null?null:s.hasError("pattern")),m(5),c("ngIf",(u=C.detailsForm.get("location"))==null?null:u.hasError("required")),m(6),c("ngForOf",C.reasonOptions),m(),c("ngIf",(_=C.detailsForm.get("reason"))==null?null:_.hasError("required")),m(),c("ngIf",((S=C.detailsForm.get("reason"))==null?null:S.value)==="other"),m(4),c("disabled",C.detailsForm.invalid)}}function pn(i,t){i&1&&l(0,"Driver Selection")}function un(i,t){i&1&&(a(0,"div",31),f(1,"mat-spinner",32),a(2,"span"),l(3,"Loading available drivers..."),o()())}function gn(i,t){i&1&&(a(0,"mat-error"),l(1," Please select a driver "),o())}function vn(i,t){if(i&1&&f(0,"img",61),i&2){let e=p().$implicit;Me("alt",e.displayName),c("src",e.photoURL,xe)}}function fn(i,t){i&1&&(a(0,"mat-icon"),l(1,"person"),o())}function _n(i,t){if(i&1){let e=w();a(0,"mat-list-option",54),M("click",function(){let r=g(e).$implicit,s=p(2);return v(s.driversForm.patchValue({toDriverId:r.id}))}),a(1,"div",55)(2,"div",56),d(3,vn,1,2,"img",57)(4,fn,2,0,"mat-icon",30),o(),a(5,"div",58)(6,"h4"),l(7),o(),a(8,"p"),l(9),o()(),a(10,"div",59)(11,"span",60),l(12),o()()()()}if(i&2){let e,n=t.$implicit,r=p(2);c("value",n.id)("disabled",n.id===(r.selectedJob==null?null:r.selectedJob.currentDriverId))("selected",((e=r.driversForm.get("toDriverId"))==null?null:e.value)===n.id),m(3),c("ngIf",n.photoURL),m(),c("ngIf",!n.photoURL),m(3),h(n.displayName),m(2),h(n.email),m(2),c("ngClass",n.role.toLowerCase()),m(),h(n.role)}}function Cn(i,t){if(i&1&&(a(0,"form",33)(1,"h3"),l(2,"Select New Driver"),o(),a(3,"p",48),l(4," Select the driver who will take over vehicle "),a(5,"span",49),l(6),o(),l(7," from "),a(8,"span",49),l(9),o()(),a(10,"div",50),d(11,gn,2,0,"mat-error",30),a(12,"mat-selection-list",51,1),d(14,_n,13,9,"mat-list-option",52),o()(),a(15,"div",26)(16,"button",53),l(17,"Back"),o(),a(18,"button",45),l(19," Next "),o()()()),i&2){let e,n,r,s=p();c("formGroup",s.driversForm),m(6),h((e=s.detailsForm.get("vehicleId"))==null?null:e.value),m(3),h((n=s.detailsForm.get("fromDriver"))==null?null:n.value),m(2),c("ngIf",((r=s.driversForm.get("toDriverId"))==null?null:r.invalid)&&((r=s.driversForm.get("toDriverId"))==null?null:r.touched)),m(),c("multiple",!1),m(2),c("ngForOf",s.availableDrivers),m(4),c("disabled",s.driversForm.invalid)}}function hn(i,t){i&1&&l(0,"Confirmation")}function xn(i,t){if(i&1){let e=w();a(0,"div",62)(1,"canvas",63,2),M("mousedown",function(r){g(e);let s=p();return v(s.startDrawing(r,"from"))})("mousemove",function(r){g(e);let s=p();return v(s.draw(r,"from"))})("mouseup",function(){g(e);let r=p();return v(r.stopDrawing("from"))})("mouseleave",function(){g(e);let r=p();return v(r.stopDrawing("from"))})("touchstart",function(r){g(e);let s=p();return v(s.startDrawing(r,"from"))})("touchmove",function(r){g(e);let s=p();return v(s.draw(r,"from"))})("touchend",function(){g(e);let r=p();return v(r.stopDrawing("from"))}),o(),a(3,"button",64),M("click",function(){g(e);let r=p();return v(r.clearSignature("from"))}),a(4,"mat-icon"),l(5,"delete"),o(),l(6," Clear "),o()()}}function bn(i,t){i&1&&(a(0,"mat-error"),l(1," Reason for skipping signature is required "),o())}function Mn(i,t){if(i&1&&(a(0,"div",65)(1,"mat-form-field",24)(2,"mat-label"),l(3,"Reason for skipping signature"),o(),f(4,"textarea",66),d(5,bn,2,0,"mat-error",30),o()()),i&2){let e,n=p();m(5),c("ngIf",(e=n.confirmationForm.get("fromSignatureNotes"))==null?null:e.hasError("required"))}}function Sn(i,t){if(i&1){let e=w();a(0,"div",62)(1,"canvas",63,3),M("mousedown",function(r){g(e);let s=p();return v(s.startDrawing(r,"to"))})("mousemove",function(r){g(e);let s=p();return v(s.draw(r,"to"))})("mouseup",function(){g(e);let r=p();return v(r.stopDrawing("to"))})("mouseleave",function(){g(e);let r=p();return v(r.stopDrawing("to"))})("touchstart",function(r){g(e);let s=p();return v(s.startDrawing(r,"to"))})("touchmove",function(r){g(e);let s=p();return v(s.draw(r,"to"))})("touchend",function(){g(e);let r=p();return v(r.stopDrawing("to"))}),o(),a(3,"button",64),M("click",function(){g(e);let r=p();return v(r.clearSignature("to"))}),a(4,"mat-icon"),l(5,"delete"),o(),l(6," Clear "),o()()}}function Dn(i,t){i&1&&(a(0,"mat-error"),l(1," Reason for skipping signature is required "),o())}function On(i,t){if(i&1&&(a(0,"div",65)(1,"mat-form-field",24)(2,"mat-label"),l(3,"Reason for skipping signature"),o(),f(4,"textarea",67),d(5,Dn,2,0,"mat-error",30),o()()),i&2){let e,n=p();m(5),c("ngIf",(e=n.confirmationForm.get("toSignatureNotes"))==null?null:e.hasError("required"))}}function Pn(i,t){i&1&&f(0,"mat-spinner",68)}function wn(i,t){i&1&&(a(0,"span"),l(1,"Complete Handover"),o())}var ge=class i{constructor(t,e,n,r,s){this.dialogRef=t;this.fb=e;this.firestore=n;this.firebaseService=r;this.snackBar=s;this.detailsForm=this.fb.group({jobId:["",D.required],vehicleId:[{value:"",disabled:!0}],fromDriver:[{value:"",disabled:!0}],odometer:["",[D.required,D.min(0),D.pattern(/^[0-9]+$/)]],location:["",D.required],reason:["",D.required],customReason:[""]}),this.driversForm=this.fb.group({toDriverId:["",D.required]}),this.confirmationForm=this.fb.group({skipFromSignature:[!1],skipToSignature:[!1],fromSignatureNotes:[""],toSignatureNotes:[""],notes:[""]}),this.confirmationForm.get("skipFromSignature")?.valueChanges.subscribe(u=>{let _=this.confirmationForm.get("fromSignatureNotes");u?_?.setValidators([D.required]):_?.clearValidators(),_?.updateValueAndValidity()}),this.confirmationForm.get("skipToSignature")?.valueChanges.subscribe(u=>{let _=this.confirmationForm.get("toSignatureNotes");u?_?.setValidators([D.required]):_?.clearValidators(),_?.updateValueAndValidity()})}detailsForm;driversForm;confirmationForm;fromSignatureCanvas;toSignatureCanvas;activeJobs=[];availableDrivers=[];reasonOptions=[{value:"standardBreak",label:"Standard Break"},{value:"emergency",label:"Emergency"},{value:"plannedRotation",label:"Planned Rotation"},{value:"other",label:"Other"}];loadingJobs=!1;loadingDrivers=!1;submitting=!1;fromDrawing=!1;toDrawing=!1;fromSignatureContext=null;toSignatureContext=null;selectedJob=null;jobsSubscription=null;driversSubscription=null;ngOnInit(){this.loadActiveJobs(),this.loadAvailableDrivers(),this.detailsForm.get("jobId")?.valueChanges.subscribe(t=>{if(t){let e=this.activeJobs.find(n=>n.id===t);e&&(this.selectedJob=e,this.detailsForm.patchValue({vehicleId:e.vehicleId,fromDriver:e.currentDriver}))}}),this.detailsForm.get("reason")?.valueChanges.subscribe(t=>{let e=this.detailsForm.get("customReason");t==="other"?e?.setValidators([D.required]):e?.clearValidators(),e?.updateValueAndValidity()})}ngOnDestroy(){this.jobsSubscription&&this.jobsSubscription.unsubscribe(),this.driversSubscription&&this.driversSubscription.unsubscribe()}loadActiveJobs(){this.loadingJobs=!0;let t=V(this.firestore,"jobs"),e=R(t,N("status","not-in",["completed","cancelled"]));this.jobsSubscription=this.firebaseService.getCollectionWithSnapshot("jobs",[N("status","not-in",["completed","cancelled"])]).subscribe(n=>{this.activeJobs=n.map(r=>({id:r.id,jobId:r.jobId||r.id,vehicleId:r.vehicleId||"N/A",currentDriverId:r.currentDriverId||"N/A",currentDriver:r.currentDriver||"N/A",status:r.status})),this.loadingJobs=!1},n=>{console.error("Error loading active jobs:",n),this.snackBar.open("Error loading active jobs","Close",{duration:5e3,panelClass:"error-snackbar"}),this.loadingJobs=!1})}loadAvailableDrivers(){this.loadingDrivers=!0;let t=V(this.firestore,"users"),e=R(t,N("role","in",["Driver","Admin","SuperAdmin"]));this.driversSubscription=this.firebaseService.getCollectionWithSnapshot("users",[N("role","in",["Driver","Admin","SuperAdmin"])]).subscribe(n=>{this.availableDrivers=n.map(r=>({id:r.id,displayName:r.displayName||r.email||"Unknown Driver",email:r.email||"N/A",photoURL:r.photoURL,role:r.role||"Driver"})),this.loadingDrivers=!1},n=>{console.error("Error loading available drivers:",n),this.snackBar.open("Error loading available drivers","Close",{duration:5e3,panelClass:"error-snackbar"}),this.loadingDrivers=!1})}initializeSignatureCanvases(){if(this.fromSignatureCanvas&&this.toSignatureCanvas){let t=this.fromSignatureCanvas.nativeElement,e=this.toSignatureCanvas.nativeElement;this.fromSignatureContext=t.getContext("2d"),this.toSignatureContext=e.getContext("2d"),this.fromSignatureContext&&this.toSignatureContext&&(this.fromSignatureContext.lineWidth=2,this.fromSignatureContext.strokeStyle="#4A3C31",this.fromSignatureContext.lineJoin="round",this.fromSignatureContext.lineCap="round",this.toSignatureContext.lineWidth=2,this.toSignatureContext.strokeStyle="#4A3C31",this.toSignatureContext.lineJoin="round",this.toSignatureContext.lineCap="round")}}startDrawing(t,e){if(t.preventDefault(),e==="from"){if(this.confirmationForm.get("skipFromSignature")?.value)return;this.fromDrawing=!0;let n=this.getClientX(t),r=this.getClientY(t),u=this.fromSignatureCanvas.nativeElement.getBoundingClientRect();this.fromSignatureContext?.beginPath(),this.fromSignatureContext?.moveTo(n-u.left,r-u.top)}else{if(this.confirmationForm.get("skipToSignature")?.value)return;this.toDrawing=!0;let n=this.getClientX(t),r=this.getClientY(t),u=this.toSignatureCanvas.nativeElement.getBoundingClientRect();this.toSignatureContext?.beginPath(),this.toSignatureContext?.moveTo(n-u.left,r-u.top)}}draw(t,e){if(t.preventDefault(),e==="from"&&this.fromDrawing){let n=this.getClientX(t),r=this.getClientY(t),u=this.fromSignatureCanvas.nativeElement.getBoundingClientRect();this.fromSignatureContext?.lineTo(n-u.left,r-u.top),this.fromSignatureContext?.stroke()}else if(e==="to"&&this.toDrawing){let n=this.getClientX(t),r=this.getClientY(t),u=this.toSignatureCanvas.nativeElement.getBoundingClientRect();this.toSignatureContext?.lineTo(n-u.left,r-u.top),this.toSignatureContext?.stroke()}}stopDrawing(t){t==="from"?this.fromDrawing=!1:this.toDrawing=!1}getClientX(t){return t instanceof MouseEvent?t.clientX:t.touches[0].clientX}getClientY(t){return t instanceof MouseEvent?t.clientY:t.touches[0].clientY}clearSignature(t){if(t==="from"&&this.fromSignatureContext){let e=this.fromSignatureCanvas.nativeElement;this.fromSignatureContext.clearRect(0,0,e.width,e.height)}else if(t==="to"&&this.toSignatureContext){let e=this.toSignatureCanvas.nativeElement;this.toSignatureContext.clearRect(0,0,e.width,e.height)}}isSignatureEmpty(t){if(t==="from"){let e=this.fromSignatureCanvas?.nativeElement;if(!e)return!0;let n=e.getContext("2d");if(!n)return!0;let r=n.getImageData(0,0,e.width,e.height).data;for(let s=3;s<r.length;s+=4)if(r[s]>0)return!1;return!0}else{let e=this.toSignatureCanvas?.nativeElement;if(!e)return!0;let n=e.getContext("2d");if(!n)return!0;let r=n.getImageData(0,0,e.width,e.height).data;for(let s=3;s<r.length;s+=4)if(r[s]>0)return!1;return!0}}getDriverName(t){let e=this.availableDrivers.find(n=>n.id===t);return e?e.displayName:"Unknown Driver"}getReasonLabel(){let t=this.detailsForm.get("reason")?.value;return t==="other"?this.detailsForm.get("customReason")?.value||"":this.reasonOptions.find(e=>e.value===t)?.label||""}submitHandover(){if(this.submitting=!0,!this.detailsForm.valid||!this.driversForm.valid||!this.confirmationForm.valid){this.snackBar.open("Please complete all required fields","Close",{duration:5e3}),this.submitting=!1;return}let t=this.confirmationForm.get("skipFromSignature")?.value,e=this.confirmationForm.get("skipToSignature")?.value;if(!t&&this.isSignatureEmpty("from")){this.snackBar.open("From driver signature is required","Close",{duration:5e3}),this.submitting=!1;return}if(!e&&this.isSignatureEmpty("to")){this.snackBar.open("To driver signature is required","Close",{duration:5e3}),this.submitting=!1;return}let n=this.activeJobs.find(b=>b.id===this.detailsForm.get("jobId")?.value),r=this.driversForm.get("toDriverId")?.value,s=this.getDriverName(r),u=this.detailsForm.get("reason")?.value,_=this.detailsForm.get("customReason")?.value,S=null,C=null;t||(S=this.fromSignatureCanvas.nativeElement.toDataURL()),e||(C=this.toSignatureCanvas.nativeElement.toDataURL());let E={jobId:n?.jobId||"Unknown",vehicleId:n?.vehicleId||"Unknown",fromDriver:n?.currentDriver||"Unknown",fromDriverId:n?.currentDriverId||"Unknown",toDriver:s,toDriverId:r,timestamp:fe(),location:this.detailsForm.get("location")?.value,odometer:parseInt(this.detailsForm.get("odometer")?.value),reason:u==="other"?_:this.reasonOptions.find(b=>b.value===u)?.label,notes:this.confirmationForm.get("notes")?.value||"",fromSignature:S,toSignature:C,fromSignatureNotes:t?this.confirmationForm.get("fromSignatureNotes")?.value:"",toSignatureNotes:e?this.confirmationForm.get("toSignatureNotes")?.value:"",status:"completed"},j=V(this.firestore,"driverHandovers");Te(j,E).then(b=>{n?this.firebaseService.updateDocument("jobs",n.id,{currentDriverId:r,currentDriver:s,lastHandoverTimestamp:fe()}).then(()=>{this.dialogRef.close(F(I({},E),{id:b.id}))}).catch(L=>{console.error("Error updating job:",L),this.snackBar.open("Handover created but job not updated","Close",{duration:5e3}),this.dialogRef.close(F(I({},E),{id:b.id}))}):this.dialogRef.close(F(I({},E),{id:b.id}))}).catch(b=>{console.error("Error creating handover:",b),this.snackBar.open("Error creating handover","Close",{duration:5e3,panelClass:"error-snackbar"}),this.submitting=!1})}cancel(){this.dialogRef.close()}static \u0275fac=function(e){return new(e||i)(x(ht),x(je),x(A),x(Q),x(se))};static \u0275cmp=B({type:i,selectors:[["app-handover-dialog"]],viewQuery:function(e,n){if(e&1&&(k(Yt,5),k(Wt,5)),e&2){let r;H(r=T())&&(n.fromSignatureCanvas=r.first),H(r=T())&&(n.toSignatureCanvas=r.first)}},decls:84,vars:24,consts:[["stepper",""],["driversList",""],["fromSignatureCanvas",""],["toSignatureCanvas",""],["mat-dialog-title",""],["mat-dialog-content","",1,"handover-dialog-content"],["linear",""],[3,"stepControl"],["matStepLabel",""],["class","loading-container",4,"ngIf"],[3,"formGroup",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"handover-summary"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[1,"signature-section"],[1,"signature-container"],[1,"signature-header"],["formControlName","skipFromSignature"],["class","canvas-container",4,"ngIf"],["class","signature-note-container",4,"ngIf"],["formControlName","skipToSignature"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","notes","rows","3","placeholder","Any additional information about this handover"],[1,"step-actions"],["type","button","mat-button","","matStepperPrevious",""],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["diameter","20",4,"ngIf"],[4,"ngIf"],[1,"loading-container"],["diameter","40"],[3,"formGroup"],["formControlName","jobId","required",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-row","two-columns"],["appearance","outline"],["matInput","","formControlName","vehicleId","readonly",""],["matInput","","formControlName","fromDriver","readonly",""],["matInput","","type","number","formControlName","odometer","placeholder","Current reading","required",""],["matInput","","formControlName","location","placeholder","Handover location","required",""],["formControlName","reason","required",""],["class","form-row",4,"ngIf"],["mat-button","","mat-dialog-close","","color","warn"],["mat-raised-button","","color","primary","matStepperNext","",3,"disabled"],[3,"value"],["matInput","","formControlName","customReason","rows","3","placeholder","Specify reason for handover"],[1,"step-description"],[1,"highlight"],[1,"driver-list-container"],[3,"multiple"],[3,"value","disabled","selected","click",4,"ngFor","ngForOf"],["mat-button","","matStepperPrevious",""],[3,"click","value","disabled","selected"],[1,"driver-list-item"],[1,"driver-avatar"],[3,"src","alt",4,"ngIf"],[1,"driver-info"],[1,"driver-role"],[1,"role-badge",3,"ngClass"],[3,"src","alt"],[1,"canvas-container"],["width","400","height","150",3,"mousedown","mousemove","mouseup","mouseleave","touchstart","touchmove","touchend"],["type","button","mat-button","","color","warn",3,"click"],[1,"signature-note-container"],["matInput","","formControlName","fromSignatureNotes","rows","2","placeholder","Explain why signature is being skipped"],["matInput","","formControlName","toSignatureNotes","rows","2","placeholder","Explain why signature is being skipped"],["diameter","20"]],template:function(e,n){if(e&1){let r=w();a(0,"h2",4),l(1,"Initiate Vehicle Handover"),o(),a(2,"div",5)(3,"mat-stepper",6,0)(5,"mat-step",7),d(6,Kt,1,0,"ng-template",8)(7,Zt,4,0,"div",9)(8,dn,43,11,"form",10),o(),a(9,"mat-step",7),d(10,pn,1,0,"ng-template",8)(11,un,4,0,"div",9)(12,Cn,20,7,"form",10),o(),a(13,"mat-step",7),d(14,hn,1,0,"ng-template",8),a(15,"form",11),M("ngSubmit",function(){return g(r),v(n.submitHandover())}),a(16,"h3"),l(17,"Confirm Handover"),o(),a(18,"div",12)(19,"div",13)(20,"span",14),l(21,"Job ID:"),o(),a(22,"span",15),l(23),o()(),a(24,"div",13)(25,"span",14),l(26,"Vehicle:"),o(),a(27,"span",15),l(28),o()(),a(29,"div",13)(30,"span",14),l(31,"From Driver:"),o(),a(32,"span",15),l(33),o()(),a(34,"div",13)(35,"span",14),l(36,"To Driver:"),o(),a(37,"span",15),l(38),o()(),a(39,"div",13)(40,"span",14),l(41,"Location:"),o(),a(42,"span",15),l(43),o()(),a(44,"div",13)(45,"span",14),l(46,"Odometer:"),o(),a(47,"span",15),l(48),o()(),a(49,"div",13)(50,"span",14),l(51,"Reason:"),o(),a(52,"span",15),l(53),o()()(),a(54,"div",16)(55,"h4"),l(56,"Driver Signatures"),o(),a(57,"div",17)(58,"div",18)(59,"span"),l(60),o(),a(61,"mat-checkbox",19),l(62,"Skip signature"),o()(),d(63,xn,7,0,"div",20)(64,Mn,6,1,"div",21),o(),a(65,"div",17)(66,"div",18)(67,"span"),l(68),o(),a(69,"mat-checkbox",22),l(70,"Skip signature"),o()(),d(71,Sn,7,0,"div",20)(72,On,6,1,"div",21),o()(),a(73,"div",23)(74,"mat-form-field",24)(75,"mat-label"),l(76,"Additional Notes"),o(),f(77,"textarea",25),o()(),a(78,"div",26)(79,"button",27),l(80,"Back"),o(),a(81,"button",28),d(82,Pn,1,0,"mat-spinner",29)(83,wn,2,0,"span",30),o()()()()()()}if(e&2){let r,s,u,_,S,C,E,j,b,L,he;m(5),c("stepControl",n.detailsForm),m(2),c("ngIf",n.loadingJobs),m(),c("ngIf",!n.loadingJobs),m(),c("stepControl",n.driversForm),m(2),c("ngIf",n.loadingDrivers),m(),c("ngIf",!n.loadingDrivers),m(),c("stepControl",n.confirmationForm),m(2),c("formGroup",n.confirmationForm),m(8),h(n.selectedJob==null?null:n.selectedJob.jobId),m(5),h((r=n.detailsForm.get("vehicleId"))==null?null:r.value),m(5),h((s=n.detailsForm.get("fromDriver"))==null?null:s.value),m(5),h(n.getDriverName((u=n.driversForm.get("toDriverId"))==null?null:u.value)),m(5),h((_=n.detailsForm.get("location"))==null?null:_.value),m(5),h((S=n.detailsForm.get("odometer"))==null?null:S.value),m(5),h(n.getReasonLabel()),m(7),y("From Driver: ",(C=n.detailsForm.get("fromDriver"))==null?null:C.value,""),m(3),c("ngIf",!((E=n.confirmationForm.get("skipFromSignature"))!=null&&E.value)),m(),c("ngIf",(j=n.confirmationForm.get("skipFromSignature"))==null?null:j.value),m(4),y("To Driver: ",n.getDriverName((b=n.driversForm.get("toDriverId"))==null?null:b.value),""),m(3),c("ngIf",!((L=n.confirmationForm.get("skipToSignature"))!=null&&L.value)),m(),c("ngIf",(he=n.confirmationForm.get("skipToSignature"))==null?null:he.value),m(9),c("disabled",n.submitting||n.confirmationForm.invalid),m(),c("ngIf",n.submitting),m(),c("ngIf",!n.submitting)}},dependencies:[J,ye,Ee,q,K,X,$,Ve,G,U,Ne,Y,W,ue,bt,Mt,St,re,oe,It,Pt,Ot,wt,yt,Et,te,ee,Z,Je,ie,ne,ze,Ue,Ge,Dt,Vt,Tt,le,ae,$e,me,Ht,kt,Ft,ce],styles:["[_nghost-%COMP%]{display:block}h2[mat-dialog-title][_ngcontent-%COMP%]{color:#4a3c31;font-size:24px;margin:0 0 16px;padding-bottom:8px;border-bottom:1px solid #e0e0e0}.handover-dialog-content[_ngcontent-%COMP%]{width:100%;max-height:70vh;overflow-y:auto;padding:0}.form-row[_ngcontent-%COMP%]{margin-bottom:16px}.form-row.two-columns[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}@media (max-width: 600px){.form-row.two-columns[_ngcontent-%COMP%]{grid-template-columns:1fr}}.form-row[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.step-description[_ngcontent-%COMP%]{color:#9e9e9e;margin-bottom:24px}.step-description[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{color:#4a3c31;font-weight:500}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 0;color:#9e9e9e}.loading-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.loading-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]     circle{stroke:#c19a6b}.driver-list-container[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;margin-bottom:24px;border:1px solid #e0e0e0;border-radius:4px}.driver-list-container[_ngcontent-%COMP%]   .mat-mdc-list-option[disabled][_ngcontent-%COMP%]{opacity:.5}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:8px 0}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;overflow:hidden;background-color:#e0e0e0;display:flex;align-items:center;justify-content:center;margin-right:16px}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#9e9e9e}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]{flex:1}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:16px;font-weight:500;color:#333}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:14px;color:#9e9e9e}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-role[_ngcontent-%COMP%]   .role-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;text-transform:uppercase}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-role[_ngcontent-%COMP%]   .role-badge.driver[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-role[_ngcontent-%COMP%]   .role-badge.admin[_ngcontent-%COMP%]{background-color:#c19a6b;color:#fff}.driver-list-container[_ngcontent-%COMP%]   .driver-list-item[_ngcontent-%COMP%]   .driver-role[_ngcontent-%COMP%]   .role-badge.superadmin[_ngcontent-%COMP%]{background-color:#4a3c31;color:#fff}.handover-summary[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:16px;border-radius:4px;margin-bottom:24px}.handover-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{margin-bottom:8px;display:flex}.handover-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.handover-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-weight:500;min-width:120px;color:#4a3c31}.handover-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{flex:1}.signature-section[_ngcontent-%COMP%]{margin-bottom:24px}.signature-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#4a3c31;margin-bottom:16px}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]{margin-bottom:24px}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]:last-child{margin-bottom:0}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .signature-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .signature-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]{position:relative;border:1px solid #e0e0e0;border-radius:4px;overflow:hidden;background-color:#fff}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:block;width:100%;border-radius:4px;touch-action:none;cursor:crosshair}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px;background-color:#fffc;padding:4px 8px;font-size:12px;min-width:auto;line-height:1}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;height:16px;width:16px;line-height:1;margin-right:4px}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .signature-note-container[_ngcontent-%COMP%]{margin-top:8px}.step-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:24px;padding-top:16px;border-top:1px solid #e0e0e0}.step-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px}.step-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{margin-left:0}.step-actions[_ngcontent-%COMP%]   button[color=primary][_ngcontent-%COMP%]{background-color:#c19a6b}.step-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{display:inline-block;margin-right:8px}.step-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]     circle{stroke:#fff}  .mat-mdc-form-field-focus-overlay{background-color:#c19a6b1a}  .mat-step-header .mat-step-icon-selected{background-color:#c19a6b!important}  .mat-step-header .mat-step-icon-state-edit{background-color:#c19a6b!important}  .mat-step-header .mat-step-label.mat-step-label-active{color:#4a3c31}  .mat-stepper-horizontal-line{border-top-color:#e0e0e0!important}  .mat-mdc-checkbox .mdc-checkbox .mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background{background-color:#c19a6b!important;border-color:#c19a6b!important}@media (max-width: 768px){.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .signature-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .signature-header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-bottom:8px}.signature-section[_ngcontent-%COMP%]   .signature-container[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{height:120px}}"]})};var yn=()=>[10,25,50,100];function En(i,t){if(i&1){let e=w();a(0,"button",45),M("click",function(){g(e);let r=p();return v(r.clearFilters())}),a(1,"mat-icon"),l(2,"clear"),o(),l(3," Clear Filters "),o()}}function In(i,t){i&1&&(a(0,"div",46),f(1,"mat-spinner",47),o())}function Fn(i,t){i&1&&(a(0,"th",48),l(1,"Job ID"),o())}function kn(i,t){if(i&1&&(a(0,"td",49),l(1),o()),i&2){let e=t.$implicit;m(),h(e.jobId)}}function Hn(i,t){i&1&&(a(0,"th",48),l(1,"Vehicle"),o())}function Tn(i,t){if(i&1&&(a(0,"td",49),l(1),o()),i&2){let e=t.$implicit;m(),y(" ",e.vehicleId," ")}}function Vn(i,t){i&1&&(a(0,"th",48),l(1," From Driver "),o())}function Rn(i,t){if(i&1&&(a(0,"td",49),l(1),o()),i&2){let e=t.$implicit;m(),y(" ",e.fromDriver," ")}}function Nn(i,t){i&1&&(a(0,"th",48),l(1,"To Driver"),o())}function jn(i,t){if(i&1&&(a(0,"td",49),l(1),o()),i&2){let e=t.$implicit;m(),h(e.toDriver)}}function Ln(i,t){i&1&&(a(0,"th",48),l(1,"Timestamp"),o())}function Bn(i,t){if(i&1&&(a(0,"td",49),l(1),o()),i&2){let e=t.$implicit,n=p();m(),y(" ",n.formatTimestamp(e.timestamp)," ")}}function qn(i,t){i&1&&(a(0,"th",48),l(1,"Location"),o())}function Jn(i,t){if(i&1&&(a(0,"td",49),l(1),o()),i&2){let e=t.$implicit;m(),h(e.location)}}function An(i,t){i&1&&(a(0,"th",48),l(1,"Odometer"),o())}function Qn(i,t){if(i&1&&(a(0,"td",49),l(1),Pe(2,"number"),o()),i&2){let e=t.$implicit;m(),y(" ",we(2,1,e.odometer)," ")}}function $n(i,t){i&1&&(a(0,"th",50),l(1,"Notes"),o())}function Gn(i,t){if(i&1&&(a(0,"td",51),l(1),o()),i&2){let e=t.$implicit;c("matTooltip",e.notes),m(),y(" ",e.notes," ")}}function Un(i,t){i&1&&f(0,"th",50)}function zn(i,t){if(i&1){let e=w();a(0,"td",52)(1,"button",53),M("click",function(){let r=g(e).$implicit,s=p();return v(s.navigateToJob(r.jobId))}),a(2,"mat-icon"),l(3,"visibility"),o()()()}}function Xn(i,t){i&1&&f(0,"tr",54)}function Yn(i,t){if(i&1){let e=w();a(0,"tr",55),M("click",function(){let r=g(e).$implicit,s=p();return v(s.navigateToJob(r.jobId))}),o()}}function Wn(i,t){i&1&&(a(0,"div"),l(1,"Loading handovers..."),o())}function Kn(i,t){i&1&&(a(0,"span"),l(1," with the current filters "),o())}function Zn(i,t){if(i&1&&(a(0,"div"),l(1," No handovers found "),d(2,Kn,2,0,"span",58),o()),i&2){let e,n=p(2);m(2),c("ngIf",((e=n.filterForm.get("searchQuery"))==null?null:e.value)||((e=n.filterForm.get("dateRange.start"))==null?null:e.value))}}function ei(i,t){if(i&1&&(a(0,"tr",56)(1,"td",57),d(2,Wn,2,0,"div",58)(3,Zn,3,1,"div",58),o()()),i&2){let e=p();m(),be("colspan",e.displayedColumns.length),m(),c("ngIf",e.loading),m(),c("ngIf",!e.loading)}}var Nt=class i{constructor(t,e,n,r,s,u){this.firestore=t;this.firebaseService=e;this.auditLogsService=n;this.dialog=r;this.snackBar=s;this.router=u}displayedColumns=["jobId","vehicleId","fromDriver","toDriver","timestamp","location","odometer","notes","actions"];dataSource=[];filteredDataSource=[];filterForm=new Ce({searchQuery:new z(""),dateRange:new Ce({start:new z(null),end:new z(null)})});handoversSubscription=null;paginator;sort;loading=!0;ngOnInit(){this.loadHandovers(),this.filterForm.valueChanges.subscribe(()=>{this.applyFilters()})}ngAfterViewInit(){this.paginator&&this.sort&&setTimeout(()=>{this.applyFilters()})}ngOnDestroy(){this.handoversSubscription&&this.handoversSubscription.unsubscribe()}loadHandovers(){this.loading=!0;let t=V(this.firestore,"driverHandovers"),e=R(t,_e("timestamp","desc"));this.handoversSubscription=this.firebaseService.getCollectionWithSnapshot("driverHandovers",[_e("timestamp","desc")]).subscribe(n=>{this.dataSource=n.map(r=>F(I({},r),{timestamp:r.timestamp instanceof He?r.timestamp.toDate():r.timestamp})),this.applyFilters(),this.loading=!1},n=>{console.error("Error loading handovers:",n),this.snackBar.open("Error loading handovers","Close",{duration:5e3,panelClass:"error-snackbar"}),this.loading=!1})}applyFilters(){let t=this.filterForm.get("searchQuery")?.value?.toLowerCase()||"",e=this.filterForm.get("dateRange.start")?.value,n=this.filterForm.get("dateRange.end")?.value;this.filteredDataSource=this.dataSource.filter(r=>{let s=t===""||r.jobId.toLowerCase().includes(t)||r.fromDriver.toLowerCase().includes(t)||r.toDriver.toLowerCase().includes(t)||r.vehicleId.toLowerCase().includes(t),u=r.timestamp instanceof Date?r.timestamp:new Date(r.timestamp),_=!0;if(e&&n){let S=new Date(n);S.setHours(23,59,59,999),_=u>=e&&u<=S}return s&&_})}clearFilters(){this.filterForm.reset(),this.applyFilters()}openHandoverDialog(){return ve(this,null,function*(){this.dialog.open(ge,{width:"650px",disableClose:!0}).afterClosed().subscribe(e=>ve(this,null,function*(){e&&(this.auditLogsService.createAuditLog({action:"create",resource:"driverHandover",resourceId:e.id,details:`Handover initiated from ${e.fromDriver} to ${e.toDriver} for job ${e.jobId}`,userId:(yield this.firebaseService.user$.toPromise())?.uid||"unknown",userName:(yield this.firebaseService.user$.toPromise())?.displayName||"Unknown User"}).catch(n=>{console.error("Error creating audit log:",n)}),this.snackBar.open("Handover successfully initiated","Close",{duration:5e3}))}))})}navigateToJob(t){this.router.navigate(["/jobs/edit",t])}formatTimestamp(t){return t?(t instanceof Date?t:new Date(t)).toLocaleString():"N/A"}static \u0275fac=function(e){return new(e||i)(x(A),x(Q),x(Rt),x(xt),x(se),x(Fe))};static \u0275cmp=B({type:i,selectors:[["app-handovers"]],viewQuery:function(e,n){if(e&1&&(k(de,5),k(pe,5)),e&2){let r;H(r=T())&&(n.paginator=r.first),H(r=T())&&(n.sort=r.first)}},decls:73,vars:11,consts:[["picker",""],[1,"handovers-container"],[1,"header-card"],[1,"header-flex"],[1,"title-section"],[1,"page-title"],[1,"page-subtitle"],[1,"actions-section"],["mat-raised-button","","color","primary",1,"primary-button",3,"click"],[1,"filter-card"],[3,"formGroup"],[1,"filter-container"],[1,"search-field"],["appearance","outline"],["matInput","","formControlName","searchQuery","placeholder","Search by Job ID, Driver name, or Vehicle ID"],["matSuffix",""],["formGroupName","dateRange",1,"date-range-field"],[3,"rangePicker"],["matStartDate","","formControlName","start","placeholder","Start date"],["matEndDate","","formControlName","end","placeholder","End date"],["matIconSuffix","",3,"for"],[1,"clear-filters"],["mat-button","","color","warn",3,"click",4,"ngIf"],[1,"table-card"],["class","loading-shade",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",1,"handovers-table",3,"dataSource"],["matColumnDef","jobId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","vehicleId"],["matColumnDef","fromDriver"],["matColumnDef","toDriver"],["matColumnDef","timestamp"],["matColumnDef","location"],["matColumnDef","odometer"],["matColumnDef","notes"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","notes-cell",3,"matTooltip",4,"matCellDef"],["matColumnDef","actions"],["mat-cell","","class","actions-cell",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","handover-row",3,"click",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","","aria-label","Select page of handovers",3,"pageSize","pageSizeOptions"],["mat-button","","color","warn",3,"click"],[1,"loading-shade"],["diameter","50"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-cell","",1,"notes-cell",3,"matTooltip"],["mat-cell","",1,"actions-cell"],["mat-icon-button","","color","primary","matTooltip","View Job Details",3,"click"],["mat-header-row",""],["mat-row","",1,"handover-row",3,"click"],[1,"mat-row"],[1,"mat-cell","no-data-cell"],[4,"ngIf"]],template:function(e,n){if(e&1){let r=w();a(0,"div",1)(1,"mat-card",2)(2,"mat-card-content")(3,"div",3)(4,"div",4)(5,"h1",5),l(6,"Driver Handovers"),o(),a(7,"p",6),l(8," Manage and track vehicle handovers between drivers "),o()(),a(9,"div",7)(10,"button",8),M("click",function(){return g(r),v(n.openHandoverDialog())}),a(11,"mat-icon"),l(12,"swap_horiz"),o(),l(13," Initiate Handover "),o()()()()(),a(14,"mat-card",9)(15,"mat-card-content")(16,"form",10)(17,"div",11)(18,"div",12)(19,"mat-form-field",13)(20,"mat-label"),l(21,"Search"),o(),f(22,"input",14),a(23,"mat-icon",15),l(24,"search"),o()()(),a(25,"div",16)(26,"mat-form-field",13)(27,"mat-label"),l(28,"Date Range"),o(),a(29,"mat-date-range-input",17),f(30,"input",18)(31,"input",19),o(),f(32,"mat-datepicker-toggle",20)(33,"mat-date-range-picker",null,0),o()(),a(35,"div",21),d(36,En,4,0,"button",22),o()()()()(),a(37,"mat-card",23)(38,"mat-card-content"),d(39,In,2,0,"div",24),a(40,"div",25)(41,"table",26),O(42,27),d(43,Fn,2,0,"th",28)(44,kn,2,1,"td",29),P(),O(45,30),d(46,Hn,2,0,"th",28)(47,Tn,2,1,"td",29),P(),O(48,31),d(49,Vn,2,0,"th",28)(50,Rn,2,1,"td",29),P(),O(51,32),d(52,Nn,2,0,"th",28)(53,jn,2,1,"td",29),P(),O(54,33),d(55,Ln,2,0,"th",28)(56,Bn,2,1,"td",29),P(),O(57,34),d(58,qn,2,0,"th",28)(59,Jn,2,1,"td",29),P(),O(60,35),d(61,An,2,0,"th",28)(62,Qn,3,3,"td",29),P(),O(63,36),d(64,$n,2,0,"th",37)(65,Gn,2,2,"td",38),P(),O(66,39),d(67,Un,1,0,"th",37)(68,zn,4,0,"td",40),P(),d(69,Xn,1,0,"tr",41)(70,Yn,1,0,"tr",42)(71,ei,4,3,"tr",43),o()(),f(72,"mat-paginator",44),o()()()}if(e&2){let r,s=Se(34);m(16),c("formGroup",n.filterForm),m(13),c("rangePicker",s),m(3),c("for",s),m(4),c("ngIf",((r=n.filterForm.get("searchQuery"))==null?null:r.value)||((r=n.filterForm.get("dateRange.start"))==null?null:r.value)),m(3),c("ngIf",n.loading),m(2),c("dataSource",n.filteredDataSource),m(28),c("matHeaderRowDef",n.displayedColumns),m(),c("matRowDefColumns",n.displayedColumns),m(2),c("pageSize",50)("pageSizeOptions",Oe(10,yn))}},dependencies:[J,q,Ie,ke,K,X,$,G,U,Y,W,Re,dt,et,nt,at,it,tt,lt,ot,rt,mt,st,ct,We,de,Ze,pe,Ke,ie,ne,ee,Z,Ae,te,re,oe,Qe,le,ae,Ct,ut,gt,vt,ft,_t,pt,qe,Le,Be,Ye,Xe,ue,ce,me],styles:[".handovers-container[_ngcontent-%COMP%]{padding:20px;background-color:#f5f5f5;min-height:calc(100vh - 64px)}.header-card[_ngcontent-%COMP%]{margin-bottom:20px;border-radius:8px;box-shadow:0 2px 6px #0000001a}.header-card[_ngcontent-%COMP%]   .header-flex[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}@media (max-width: 768px){.header-card[_ngcontent-%COMP%]   .header-flex[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}}.header-card[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:24px;font-weight:500;color:#4a3c31;margin:0 0 4px}.header-card[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{color:#9e9e9e;margin:0}.header-card[_ngcontent-%COMP%]   .actions-section[_ngcontent-%COMP%]   .primary-button[_ngcontent-%COMP%]{background-color:#c19a6b;color:#fff}.filter-card[_ngcontent-%COMP%]{margin-bottom:20px;border-radius:8px;box-shadow:0 2px 6px #0000001a}.filter-card[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}@media (max-width: 992px){.filter-card[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}.filter-card[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{flex:2}.filter-card[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.filter-card[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]   .date-range-field[_ngcontent-%COMP%]{flex:1}.filter-card[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]   .date-range-field[_ngcontent-%COMP%]   .mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.filter-card[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]   .clear-filters[_ngcontent-%COMP%]{min-width:120px;display:flex;justify-content:flex-end}@media (max-width: 992px){.filter-card[_ngcontent-%COMP%]   .filter-container[_ngcontent-%COMP%]   .clear-filters[_ngcontent-%COMP%]{justify-content:flex-start}}.table-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 2px 6px #0000001a;position:relative;min-height:400px}.table-card[_ngcontent-%COMP%]   .loading-shade[_ngcontent-%COMP%]{position:absolute;inset:0;background:#0000000d;z-index:1;display:flex;align-items:center;justify-content:center;border-radius:8px}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{overflow-x:auto;min-height:300px}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]{width:100%}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{background-color:#4a3c31;color:#fff;font-weight:500;padding:12px 16px;white-space:nowrap}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{padding:12px 16px}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]:nth-child(2n){background-color:#00000005}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]:hover{background-color:#c19a6b0d;cursor:pointer}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .notes-cell[_ngcontent-%COMP%]{max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .actions-cell[_ngcontent-%COMP%]{white-space:nowrap;width:1%;text-align:right}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .no-data-cell[_ngcontent-%COMP%]{padding:30px 16px;text-align:center;color:#9e9e9e;font-style:italic}  .mat-mdc-form-field-focus-overlay{background-color:#c19a6b1a}  .mat-mdc-select-arrow{color:#4a3c31}  .mat-mdc-paginator{background-color:transparent}  .mat-mdc-raised-button.mat-primary{background-color:#c19a6b}  .mdc-text-field--focused .mdc-floating-label{color:#c19a6b}  .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{border-color:#e0e0e0}  .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{border-color:#e0e0e0}  .mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#e0e0e0}  .mdc-text-field--outlined.mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__leading{border-color:#c19a6b}  .mdc-text-field--outlined.mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__notch{border-color:#c19a6b}  .mdc-text-field--outlined.mdc-text-field--focused .mdc-notched-outline .mdc-notched-outline__trailing{border-color:#c19a6b}  .error-snackbar{background-color:#b00020;color:#fff}@media (max-width: 768px){.handovers-container[_ngcontent-%COMP%]{padding:12px}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .mat-mdc-header-row[_ngcontent-%COMP%], .table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .mat-mdc-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;height:auto}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%], .table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .mat-mdc-cell[_ngcontent-%COMP%]{flex:1 0 100px;white-space:normal;word-wrap:break-word;min-height:48px;display:flex;align-items:center}.table-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]   .handovers-table[_ngcontent-%COMP%]   .notes-cell[_ngcontent-%COMP%]{max-width:100%}}"]})};export{Nt as HandoversComponent};
