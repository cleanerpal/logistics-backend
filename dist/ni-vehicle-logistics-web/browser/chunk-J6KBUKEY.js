import"./chunk-F5X5MWHG.js";import{b as U}from"./chunk-VWFB2ZCV.js";import{a as K,b as Q}from"./chunk-6ZM5HFJH.js";import"./chunk-DJMXPRNS.js";import"./chunk-U5UIMM6O.js";import"./chunk-PP7BOOB7.js";import"./chunk-FL7UC7QU.js";import{a as X,b as Y,c as Z}from"./chunk-RGR4672A.js";import{a as ee,b as te,c as ne,d as ae,e as re,f as ie,g as oe,h as me,i as ce,j as le,l as de}from"./chunk-HITQB7VJ.js";import"./chunk-DQFV6XNM.js";import{a as B,b as H,c as F,f as z,h as L}from"./chunk-OFY7VGJP.js";import"./chunk-P7ITNQJW.js";import{a as G,b as W}from"./chunk-HDC6EVXZ.js";import{b as q}from"./chunk-Q2NIOR5G.js";import{H as N,I as j,J as V}from"./chunk-E6Y7ME2X.js";import{v as $}from"./chunk-ZO4V6NUC.js";import{ea as g,ga as k,h as E,i as J,j as R,n as I,o as A}from"./chunk-3O2P3FIP.js";import{Cb as l,Db as S,Lb as r,Mb as a,Nb as x,Ob as f,Pb as _,Rb as w,Vb as y,Wb as v,db as o,fc as i,ga as P,gc as h,hc as p,pa as b,pb as O,qa as T,tc as u,vb as d,vc as C}from"./chunk-NXWLSP6D.js";import{g as D}from"./chunk-RA2WU32H.js";function pe(e,n){e&1&&(r(0,"div",5),x(1,"mat-spinner",6),a())}function ge(e,n){if(e&1&&(r(0,"div",7)(1,"mat-card",8)(2,"mat-card-content")(3,"div",9),i(4),a(),r(5,"div",10),i(6,"On-Time Deliveries"),a()()(),r(7,"mat-card",8)(8,"mat-card-content")(9,"div",9),i(10),u(11,"number"),a(),r(12,"div",10),i(13,"Avg. Completion Time"),a()()(),r(14,"mat-card",8)(15,"mat-card-content")(16,"div",9),i(17),u(18,"number"),a(),r(19,"div",10),i(20,"Customer Satisfaction"),a()()(),r(21,"mat-card",8)(22,"mat-card-content")(23,"div",9),i(24),a(),r(25,"div",10),i(26,"Active Drivers"),a()()()()),e&2){let t=v();o(4),p("",t.overallOnTimePercentage,"%"),o(6),p(" ",C(11,4,t.averageJobCompletionTime,"1.0-0")," min "),o(7),p(" ",C(18,7,t.averageCustomerRating,"1.1-1"),"/5 "),o(7),h(t.activeDrivers)}}function fe(e,n){e&1&&(r(0,"th",24),i(1," Driver "),a())}function _e(e,n){if(e&1&&(r(0,"td",25),i(1),a()),e&2){let t=n.$implicit;o(),h(t.name)}}function ve(e,n){e&1&&(r(0,"th",24),i(1," Jobs Completed "),a())}function ue(e,n){if(e&1&&(r(0,"td",25),i(1),a()),e&2){let t=n.$implicit;o(),p(" ",t.completedJobs," ")}}function Ce(e,n){e&1&&(r(0,"th",24),i(1," On-Time % "),a())}function Pe(e,n){if(e&1&&(r(0,"td",25)(1,"div",26)(2,"div",27),i(3),a()()()),e&2){let t=n.$implicit,m=v(2);o(),l("matTooltip",t.onTimePercentage+"% on-time deliveries"),o(),S("width",t.onTimePercentage,"%"),l("ngClass",m.getOnTimeRatingClass(t.onTimePercentage)),o(),p(" ",t.onTimePercentage,"% ")}}function xe(e,n){e&1&&(r(0,"th",24),i(1," Avg. Duration "),a())}function he(e,n){if(e&1&&(r(0,"td",25),i(1),u(2,"number"),a()),e&2){let t=n.$implicit;o(),p(" ",C(2,1,t.averageJobDuration,"1.0-0")," min ")}}function Me(e,n){e&1&&(r(0,"th",24),i(1," Rating "),a())}function De(e,n){if(e&1&&(r(0,"mat-icon",32),i(1),a()),e&2){let t=n.$implicit;l("ngClass",t===1?"full-star":t===.5?"half-star":"empty-star"),o(),p(" ",t===.5?"star_half":t===1?"star":"star_border"," ")}}function be(e,n){if(e&1&&(r(0,"td",25)(1,"div",28)(2,"span",29),i(3),u(4,"number"),a(),r(5,"div",30),d(6,De,2,2,"mat-icon",31),a()()()),e&2){let t=n.$implicit,m=v(2);o(3),h(C(4,2,t.customerRating,"1.1-1")),o(3),l("ngForOf",m.getStars(t.customerRating))}}function Te(e,n){e&1&&(r(0,"th",24),i(1," Last Active "),a())}function Oe(e,n){if(e&1&&(r(0,"td",25),i(1),a()),e&2){let t=n.$implicit,m=v(2);o(),p(" ",m.formatDate(t.lastActive)," ")}}function Se(e,n){e&1&&x(0,"tr",33)}function we(e,n){e&1&&x(0,"tr",34)}function ye(e,n){if(e&1){let t=w();r(0,"mat-card",11)(1,"mat-card-header")(2,"mat-card-title"),i(3,"Driver Performance"),a()(),r(4,"mat-card-content")(5,"div",12)(6,"table",13),y("matSortChange",function(s){b(t);let c=v();return T(c.announceSortChange(s))}),f(7,14),d(8,fe,2,0,"th",15)(9,_e,2,1,"td",16),_(),f(10,17),d(11,ve,2,0,"th",15)(12,ue,2,1,"td",16),_(),f(13,18),d(14,Ce,2,0,"th",15)(15,Pe,4,5,"td",16),_(),f(16,19),d(17,xe,2,0,"th",15)(18,he,3,4,"td",16),_(),f(19,20),d(20,Me,2,0,"th",15)(21,be,7,5,"td",16),_(),f(22,21),d(23,Te,2,0,"th",15)(24,Oe,2,1,"td",16),_(),d(25,Se,1,0,"tr",22)(26,we,1,0,"tr",23),a()()()()}if(e&2){let t=v();o(6),l("dataSource",t.driverPerformance),o(19),l("matHeaderRowDef",t.displayedColumns),o(),l("matRowDefColumns",t.displayedColumns)}}var se=class e{firestore=P(k);snackBar=P(q);liveAnnouncer=P($);loading=!0;driverPerformance=[];displayedColumns=["name","completedJobs","onTimePercentage","averageJobDuration","customerRating","lastActive"];overallOnTimePercentage=0;averageJobCompletionTime=0;averageCustomerRating=0;activeDrivers=0;ngOnInit(){this.loadPerformanceData()}loadPerformanceData(){return D(this,null,function*(){this.loading=!0;try{setTimeout(()=>{this.driverPerformance=this.generateMockDriverData(),this.calculateSummaryMetrics(),this.loading=!1},1e3)}catch(n){console.error("Error loading performance data:",n),this.snackBar.open("Error loading performance data. Please try again.","Close",{duration:5e3}),this.loading=!1}})}generateMockDriverData(){return[{id:"1",name:"John Smith",completedJobs:45,onTimeDeliveries:41,onTimePercentage:91,averageJobDuration:72,customerRating:4.7,lastActive:g.fromDate(new Date(Date.now()-18e5))},{id:"2",name:"Sarah Johnson",completedJobs:38,onTimeDeliveries:35,onTimePercentage:92,averageJobDuration:68,customerRating:4.9,lastActive:g.fromDate(new Date(Date.now()-9e5))},{id:"3",name:"Michael Brown",completedJobs:52,onTimeDeliveries:39,onTimePercentage:75,averageJobDuration:85,customerRating:4.1,lastActive:g.fromDate(new Date(Date.now()-72e5))},{id:"4",name:"Emma Wilson",completedJobs:29,onTimeDeliveries:27,onTimePercentage:93,averageJobDuration:65,customerRating:4.8,lastActive:g.fromDate(new Date(Date.now()-27e5))},{id:"5",name:"David Lee",completedJobs:15,onTimeDeliveries:10,onTimePercentage:67,averageJobDuration:90,customerRating:3.5,lastActive:g.fromDate(new Date(Date.now()-864e5))},{id:"6",name:"Lisa Chen",completedJobs:41,onTimeDeliveries:36,onTimePercentage:88,averageJobDuration:75,customerRating:4.5,lastActive:g.fromDate(new Date(Date.now()-108e5))},{id:"7",name:"Robert Taylor",completedJobs:33,onTimeDeliveries:30,onTimePercentage:91,averageJobDuration:70,customerRating:4.6,lastActive:g.fromDate(new Date(Date.now()-144e5))}]}calculateSummaryMetrics(){if(this.driverPerformance.length===0)return;let n=0,t=0,m=0;this.driverPerformance.forEach(c=>{n+=c.onTimePercentage,t+=c.averageJobDuration,m+=c.customerRating}),this.overallOnTimePercentage=Math.round(n/this.driverPerformance.length),this.averageJobCompletionTime=t/this.driverPerformance.length,this.averageCustomerRating=m/this.driverPerformance.length;let s=new Date;s.setDate(s.getDate()-1),this.activeDrivers=this.driverPerformance.filter(c=>c.lastActive.toDate()>s).length}getOnTimeRatingClass(n){return n>=90?"excellent":n>=80?"good":n>=70?"average":"poor"}getStars(n){let t=[],m=Math.floor(n),s=n%1>=.5;for(let c=0;c<m;c++)t.push(1);for(s&&t.push(.5);t.length<5;)t.push(0);return t}formatDate(n){let t=new Date,m=n.toDate(),s=t.getTime()-m.getTime(),c=Math.round(s/(1e3*60));if(c<60)return`${c} min${c!==1?"s":""} ago`;if(c<1440){let M=Math.floor(c/60);return`${M} hour${M!==1?"s":""} ago`}else return m.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})}announceSortChange(n){n.direction?this.liveAnnouncer.announce(`Sorted ${n.direction}ending`):this.liveAnnouncer.announce("Sorting cleared")}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=O({type:e,selectors:[["app-performance"]],decls:6,vars:3,consts:[[1,"performance-container"],[1,"page-title"],["class","loading-container",4,"ngIf"],["class","metrics-overview",4,"ngIf"],["class","driver-performance-card",4,"ngIf"],[1,"loading-container"],["diameter","50"],[1,"metrics-overview"],[1,"metric-card"],[1,"metric-value"],[1,"metric-label"],[1,"driver-performance-card"],[1,"table-container"],["mat-table","","matSort","",3,"matSortChange","dataSource"],["matColumnDef","name"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","completedJobs"],["matColumnDef","onTimePercentage"],["matColumnDef","averageJobDuration"],["matColumnDef","customerRating"],["matColumnDef","lastActive"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"progress-container",3,"matTooltip"],[1,"progress-bar",3,"ngClass"],[1,"rating"],[1,"rating-value"],[1,"stars"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["mat-header-row",""],["mat-row",""]],template:function(t,m){t&1&&(r(0,"div",0)(1,"h1",1),i(2,"Performance Metrics"),a(),d(3,pe,2,0,"div",2)(4,ge,27,10,"div",3)(5,ye,27,3,"mat-card",4),a()),t&2&&(o(3),l("ngIf",m.loading),o(),l("ngIf",!m.loading),o(),l("ngIf",!m.loading))},dependencies:[A,E,J,R,I,L,B,F,z,H,de,ee,ne,oe,ae,te,me,re,ie,ce,le,Z,X,Y,V,j,N,U,W,G,Q,K],styles:[".performance-container[_ngcontent-%COMP%]{padding:20px;background-color:#f5f5f5;min-height:100%}.page-title[_ngcontent-%COMP%]{font-size:24px;font-weight:500;color:#4a3c31;margin-bottom:24px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:200px}.metrics-overview[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:24px}.metric-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 2px 10px #0000001a}.metric-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px 16px}.metric-card[_ngcontent-%COMP%]   .metric-value[_ngcontent-%COMP%]{font-size:32px;font-weight:600;color:#c19a6b;margin-bottom:8px}.metric-card[_ngcontent-%COMP%]   .metric-label[_ngcontent-%COMP%]{font-size:14px;color:#4a3c31;text-align:center}.driver-performance-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 2px 10px #0000001a}.driver-performance-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{padding:16px 16px 0}.driver-performance-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]   .mat-mdc-card-title[_ngcontent-%COMP%]{color:#4a3c31;font-size:18px;margin-bottom:4px}.driver-performance-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{padding:16px}.table-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto}.table-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.progress-container[_ngcontent-%COMP%]{width:100%;background-color:#e0e0e0;border-radius:4px;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{height:20px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:12px;font-weight:500}.progress-bar.excellent[_ngcontent-%COMP%]{background-color:#4caf50}.progress-bar.good[_ngcontent-%COMP%]{background-color:#8bc34a}.progress-bar.average[_ngcontent-%COMP%]{background-color:#ffc107}.progress-bar.poor[_ngcontent-%COMP%]{background-color:#f44336}.rating[_ngcontent-%COMP%]{display:flex;align-items:center}.rating[_ngcontent-%COMP%]   .rating-value[_ngcontent-%COMP%]{margin-right:8px;font-weight:500}.rating[_ngcontent-%COMP%]   .stars[_ngcontent-%COMP%]{display:flex}.rating[_ngcontent-%COMP%]   .stars[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.rating[_ngcontent-%COMP%]   .stars[_ngcontent-%COMP%]   .full-star[_ngcontent-%COMP%], .rating[_ngcontent-%COMP%]   .stars[_ngcontent-%COMP%]   .half-star[_ngcontent-%COMP%]{color:#ffc107}.rating[_ngcontent-%COMP%]   .stars[_ngcontent-%COMP%]   .empty-star[_ngcontent-%COMP%]{color:#e0e0e0}@media (max-width: 768px){.metrics-overview[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}@media (max-width: 480px){.metrics-overview[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{se as PerformanceComponent};
