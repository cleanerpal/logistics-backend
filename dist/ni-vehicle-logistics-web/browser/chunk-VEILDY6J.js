import"./chunk-DWEM3L4R.js";import{a as ae,b as ce}from"./chunk-ESJIWLK4.js";import"./chunk-F5X5MWHG.js";import{a as ie,b as oe}from"./chunk-6ZM5HFJH.js";import{c as ne}from"./chunk-4TDDZIB3.js";import"./chunk-PP7BOOB7.js";import"./chunk-DQFV6XNM.js";import{a as N,b as F,c as H,d as U,f as K,h as $}from"./chunk-OFY7VGJP.js";import"./chunk-P7ITNQJW.js";import{a as Z,b as ee}from"./chunk-HDC6EVXZ.js";import{b as te,c as re}from"./chunk-Q2NIOR5G.js";import{C as G,E as Q,H as W,I as X,J as Y}from"./chunk-E6Y7ME2X.js";import"./chunk-ZO4V6NUC.js";import{a as A,c as R,g as j}from"./chunk-4PPYA6ZN.js";import{ea as E,f as I,ga as q,h as T,i as D,j as L,m as B,ma as M,o as V,oa as z,wa as J}from"./chunk-3O2P3FIP.js";import{Cb as d,Lb as r,Mb as t,Nb as C,Rb as v,Vb as p,Wb as l,db as a,fc as o,gc as g,hc as f,ib as x,ic as O,pa as _,pb as k,qa as u,qc as P,tc as S,uc as w,vb as m}from"./chunk-NXWLSP6D.js";import{a as b,b as y,g as h}from"./chunk-RA2WU32H.js";var le=n=>({"high-retry":n});function se(n,i){n&1&&(r(0,"span"),o(1,"Mark as Resolved"),t())}function me(n,i){n&1&&(r(0,"span"),o(1,"Resolving..."),t())}function pe(n,i){if(n&1){let e=v();r(0,"button",13),p("click",function(){_(e);let c=l(2);return u(c.viewJob())}),r(1,"mat-icon"),o(2,"work"),t(),o(3," View Job "),t()}}function ge(n,i){if(n&1){let e=v();r(0,"div",9)(1,"button",10),p("click",function(){_(e);let c=l();return u(c.markAsResolved())}),r(2,"mat-icon"),o(3,"check_circle"),t(),m(4,se,2,0,"span",11)(5,me,2,0,"span",11),t(),m(6,pe,4,0,"button",12),t()}if(n&2){let e=l();a(),d("disabled",e.error.resolved||e.resolvingError),a(3),d("ngIf",!e.resolvingError),a(),d("ngIf",e.resolvingError),a(),d("ngIf",e.error.jobId)}}function _e(n,i){n&1&&(r(0,"div",14),C(1,"mat-spinner",15),t())}function ue(n,i){if(n&1){let e=v();r(0,"div",20)(1,"div",21),o(2,"Job ID"),t(),r(3,"div",30),p("click",function(){_(e);let c=l(2);return u(c.viewJob())}),o(4),t()()}if(n&2){let e=l(2);a(4),f(" ",e.error.jobId," ")}}function ve(n,i){if(n&1&&(r(0,"span"),o(1),t()),n&2){let e=l(2);a(),f(" (",e.formatDate(e.error.resolvedAt),") ")}}function xe(n,i){if(n&1&&(r(0,"div",20)(1,"div",21),o(2,"User ID"),t(),r(3,"div",22),o(4),t()()),n&2){let e=l(2);a(4),g(e.error.userId)}}function fe(n,i){if(n&1&&(r(0,"div",20)(1,"div",21),o(2,"IP Address"),t(),r(3,"div",22),o(4),t()()),n&2){let e=l(2);a(4),g(e.error.ipAddress)}}function Ce(n,i){n&1&&C(0,"mat-divider")}function be(n,i){if(n&1){let e=v();r(0,"div",31)(1,"div",32)(2,"h3"),o(3,"Stack Trace"),t(),r(4,"button",33),p("click",function(){_(e);let c=l(2);return u(c.copyToClipboard(c.error.stackTrace))}),r(5,"mat-icon"),o(6,"content_copy"),t()()(),r(7,"pre",34),o(8),t()()}if(n&2){let e=l(2);a(8),g(e.error.stackTrace)}}function he(n,i){if(n&1){let e=v();r(0,"div",36)(1,"div",32)(2,"h3"),o(3,"Request Body"),t(),r(4,"button",37),p("click",function(){_(e);let c=l(3);return u(c.copyToClipboard(c.error.requestBody))}),r(5,"mat-icon"),o(6,"content_copy"),t()()(),r(7,"pre",38),o(8),t()()}if(n&2){let e=l(3);a(8),g(e.formatJson(e.error.requestBody))}}function Ee(n,i){n&1&&C(0,"mat-divider")}function Me(n,i){if(n&1){let e=v();r(0,"div",36)(1,"div",32)(2,"h3"),o(3,"Response Body"),t(),r(4,"button",39),p("click",function(){_(e);let c=l(3);return u(c.copyToClipboard(c.error.responseBody))}),r(5,"mat-icon"),o(6,"content_copy"),t()()(),r(7,"pre",38),o(8),t()()}if(n&2){let e=l(3);a(8),g(e.formatJson(e.error.responseBody))}}function ye(n,i){if(n&1&&(r(0,"mat-card",17)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Request & Response"),t()(),r(4,"mat-card-content"),m(5,he,9,1,"div",35)(6,Ee,1,0,"mat-divider",11)(7,Me,9,1,"div",35),t()()),n&2){let e=l(2);a(5),d("ngIf",e.error.requestBody),a(),d("ngIf",e.error.requestBody&&e.error.responseBody),a(),d("ngIf",e.error.responseBody)}}function ke(n,i){if(n&1&&(r(0,"div",43)(1,"div",44),o(2),t(),r(3,"div",45),o(4),t()()),n&2){let e=i.$implicit;a(2),g(e.key),a(2),g(e.value)}}function Oe(n,i){if(n&1){let e=v();r(0,"mat-card",17)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Headers"),t(),r(4,"button",40),p("click",function(){_(e);let c=l(2);return u(c.copyToClipboard(c.formatJson(c.error.headers)))}),r(5,"mat-icon"),o(6,"content_copy"),t()()(),r(7,"mat-card-content")(8,"div",41),m(9,ke,5,2,"div",42),S(10,"keyvalue"),t()()()}if(n&2){let e=l(2);a(9),d("ngForOf",w(10,1,e.error.headers))}}function Pe(n,i){if(n&1){let e=v();r(0,"div",16)(1,"mat-card",17)(2,"mat-card-header")(3,"mat-card-title"),o(4,"Error Overview"),t(),r(5,"mat-card-subtitle")(6,"div",18),o(7),t()()(),r(8,"mat-card-content")(9,"div",19)(10,"div",20)(11,"div",21),o(12,"Timestamp"),t(),r(13,"div",22),o(14),t()(),m(15,ue,5,1,"div",23),r(16,"div",20)(17,"div",21),o(18,"Method"),t(),r(19,"div",22),o(20),t()(),r(21,"div",20)(22,"div",21),o(23,"Endpoint"),t(),r(24,"div",22),o(25),t()(),r(26,"div",20)(27,"div",21),o(28,"Retry Count"),t(),r(29,"div",24),o(30),t()(),r(31,"div",20)(32,"div",21),o(33,"Status"),t(),r(34,"div",22)(35,"span",25),o(36),t(),m(37,ve,2,1,"span",11),t()(),m(38,xe,5,1,"div",23)(39,fe,5,1,"div",23),t()()(),r(40,"mat-card",17)(41,"mat-card-header")(42,"mat-card-title"),o(43,"Error Message"),t(),r(44,"button",26),p("click",function(){_(e);let c=l();return u(c.copyToClipboard(c.error.message))}),r(45,"mat-icon"),o(46,"content_copy"),t()()(),r(47,"mat-card-content")(48,"div",27),o(49),t(),m(50,Ce,1,0,"mat-divider",11)(51,be,9,1,"div",28),t()(),m(52,ye,8,3,"mat-card",29)(53,Oe,11,3,"mat-card",29),t()}if(n&2){let e=l();a(6),d("ngClass",e.getStatusColor(e.error.status)),a(),O(" ",e.error.status," - ",e.getStatusText(e.error.status)," "),a(7),g(e.formatDate(e.error.timestamp)),a(),d("ngIf",e.error.jobId),a(5),g(e.error.method||"N/A"),a(5),g(e.error.endpoint||"N/A"),a(4),d("ngClass",P(19,le,e.error.retryCount>2)),a(),f(" ",e.error.retryCount," "),a(5),d("ngClass",e.error.resolved?"resolved":"open"),a(),f(" ",e.error.resolved?"Resolved":"Open"," "),a(),d("ngIf",e.error.resolved&&e.error.resolvedAt),a(),d("ngIf",e.error.userId),a(),d("ngIf",e.error.ipAddress),a(10),f(" ",e.error.message," "),a(),d("ngIf",e.error.stackTrace),a(),d("ngIf",e.error.stackTrace),a(),d("ngIf",e.error.requestBody||e.error.responseBody),a(),d("ngIf",e.error.headers)}}function Se(n,i){if(n&1){let e=v();r(0,"div",46)(1,"mat-icon",47),o(2,"error_outline"),t(),r(3,"h2"),o(4,"Error log not found"),t(),r(5,"p"),o(6,"The error log you're looking for doesn't exist or has been deleted."),t(),r(7,"button",48),p("click",function(){_(e);let c=l();return u(c.goBack())}),r(8,"mat-icon"),o(9,"arrow_back"),t(),o(10," Back to Error Logs "),t()()}}var de=class n{constructor(i,e,s,c,we){this.route=i;this.firestore=e;this.router=s;this.snackBar=c;this.location=we}errorId="";error;loading=!0;resolvingError=!1;routeSubscription;ngOnInit(){this.routeSubscription=this.route.paramMap.subscribe(i=>{let e=i.get("id");e?(this.errorId=e,this.loadErrorDetails()):this.router.navigate(["/error-logs"])})}ngOnDestroy(){this.routeSubscription&&this.routeSubscription.unsubscribe()}loadErrorDetails(){return h(this,null,function*(){this.loading=!0;try{let i=M(this.firestore,"ApiErrors",this.errorId),e=yield z(i);e.exists()?(this.error=b({id:e.id},e.data()),this.loading=!1):(this.snackBar.open("Error log not found.","Close",{duration:5e3,panelClass:["error-snackbar"]}),this.router.navigate(["/error-logs"]))}catch(i){console.error("Error loading error details:",i),this.snackBar.open("Error loading details. Please try again.","Close",{duration:5e3,panelClass:["error-snackbar"]}),this.loading=!1}})}markAsResolved(){return h(this,null,function*(){if(!(!this.error||this.error.resolved)){this.resolvingError=!0;try{let i=M(this.firestore,"ApiErrors",this.errorId);yield J(i,{resolved:!0,resolvedAt:E.now()}),this.error=y(b({},this.error),{resolved:!0,resolvedAt:E.now()}),this.snackBar.open("Error marked as resolved.","Close",{duration:3e3})}catch(i){console.error("Error marking as resolved:",i),this.snackBar.open("Error updating status. Please try again.","Close",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.resolvingError=!1}}})}viewJob(){this.error?.jobId&&this.router.navigate(["/jobs",this.error.jobId])}goBack(){this.location.back()}getStatusText(i){return i>=500?"Server Error":i>=400?"Client Error":i>=300?"Redirect":i>=200?"Success":i>=100?"Informational":"Unknown"}getStatusColor(i){return i>=500?"error-color":i>=400?"warning-color":i>=300?"info-color":i>=200?"success-color":""}formatDate(i){return i?i.toDate().toLocaleString():"N/A"}copyToClipboard(i){navigator.clipboard.writeText(i).then(()=>{this.snackBar.open("Copied to clipboard","Close",{duration:2e3})})}formatJson(i){return JSON.stringify(i,null,2)}static \u0275fac=function(e){return new(e||n)(x(A),x(q),x(R),x(te),x(I))};static \u0275cmp=k({type:n,selectors:[["app-error-log-details"]],decls:12,vars:4,consts:[[1,"error-details-container"],[1,"page-header"],[1,"header-left"],["mat-icon-button","","color","primary",1,"back-button",3,"click"],[1,"page-title"],["class","header-actions",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","details-content",4,"ngIf"],["class","not-found-container",4,"ngIf"],[1,"header-actions"],["mat-raised-button","","color","primary",3,"click","disabled"],[4,"ngIf"],["mat-raised-button","","color","accent",3,"click",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"loading-container"],["diameter","50"],[1,"details-content"],[1,"details-card"],[1,"status-badge",3,"ngClass"],[1,"overview-grid"],[1,"grid-item"],[1,"item-label"],[1,"item-value"],["class","grid-item",4,"ngIf"],[1,"item-value",3,"ngClass"],[1,"status-chip",3,"ngClass"],["mat-icon-button","","color","primary","matTooltip","Copy error message",3,"click"],[1,"error-message"],["class","stack-trace-container",4,"ngIf"],["class","details-card",4,"ngIf"],[1,"item-value","job-link",3,"click"],[1,"stack-trace-container"],[1,"section-header"],["mat-icon-button","","color","primary","matTooltip","Copy stack trace",3,"click"],[1,"stack-trace"],["class","request-response-container",4,"ngIf"],[1,"request-response-container"],["mat-icon-button","","color","primary","matTooltip","Copy request body",3,"click"],[1,"code-block"],["mat-icon-button","","color","primary","matTooltip","Copy response body",3,"click"],["mat-icon-button","","color","primary","matTooltip","Copy headers",3,"click"],[1,"headers-container"],["class","header-item",4,"ngFor","ngForOf"],[1,"header-item"],[1,"header-name"],[1,"header-value"],[1,"not-found-container"],[1,"not-found-icon"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,s){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),p("click",function(){return s.goBack()}),r(4,"mat-icon"),o(5,"arrow_back"),t()(),r(6,"h1",4),o(7,"Error Details"),t()(),m(8,ge,7,4,"div",5),t(),m(9,_e,2,0,"div",6)(10,Pe,54,21,"div",7)(11,Se,11,0,"div",8),t()),e&2&&(a(8),d("ngIf",s.error),a(),d("ngIf",s.loading),a(),d("ngIf",!s.loading&&s.error),a(),d("ngIf",!s.loading&&!s.error))},dependencies:[V,T,D,L,B,j,$,N,H,K,U,F,W,Q,G,Y,X,ce,ae,ne,ee,Z,re,oe,ie],styles:[".error-details-container[_ngcontent-%COMP%]{padding:20px;background-color:#f5f5f5;min-height:100%}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center}.back-button[_ngcontent-%COMP%]{margin-right:12px}.page-title[_ngcontent-%COMP%]{font-size:24px;font-weight:500;color:#4a3c31;margin:0}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}@media (max-width: 576px){.header-actions[_ngcontent-%COMP%]{flex-direction:column;width:100%}.header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:300px}.loading-container[_ngcontent-%COMP%]   .mat-mdc-progress-spinner[_ngcontent-%COMP%]     circle{stroke:#c19a6b}.details-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.details-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 2px 10px #0000001a}.details-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]{padding:16px 16px 0;display:flex;justify-content:space-between;align-items:center}.details-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]   .mat-mdc-card-title[_ngcontent-%COMP%]{color:#4a3c31;font-size:18px;margin-bottom:8px}.details-card[_ngcontent-%COMP%]   .mat-mdc-card-header[_ngcontent-%COMP%]   .mat-mdc-card-subtitle[_ngcontent-%COMP%]{margin-bottom:0}.details-card[_ngcontent-%COMP%]   .mat-mdc-card-content[_ngcontent-%COMP%]{padding:16px}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500;color:#fff;text-align:center;min-width:120px}.status-badge.error-color[_ngcontent-%COMP%]{background-color:#b00020}.status-badge.warning-color[_ngcontent-%COMP%]{background-color:#ff9800}.status-badge.info-color[_ngcontent-%COMP%]{background-color:#2196f3}.status-badge.success-color[_ngcontent-%COMP%]{background-color:#4caf50}.overview-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:16px}.overview-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]{padding:12px;background-color:#00000005;border-radius:4px}.overview-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .item-label[_ngcontent-%COMP%]{font-size:12px;color:#9e9e9e;margin-bottom:4px;font-weight:500}.overview-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .item-value[_ngcontent-%COMP%]{font-size:14px;color:#333;font-weight:500}.overview-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .item-value.job-link[_ngcontent-%COMP%]{color:#c19a6b;text-decoration:underline;cursor:pointer}.overview-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .item-value.job-link[_ngcontent-%COMP%]:hover{color:#af814a}.overview-grid[_ngcontent-%COMP%]   .grid-item[_ngcontent-%COMP%]   .item-value.high-retry[_ngcontent-%COMP%]{color:#b00020}.status-chip[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500;color:#fff}.status-chip.open[_ngcontent-%COMP%]{background-color:#b00020}.status-chip.resolved[_ngcontent-%COMP%]{background-color:#4caf50}.error-message[_ngcontent-%COMP%]{padding:16px;background-color:#b000200d;border-radius:4px;margin-bottom:16px;color:#333;font-weight:500;line-height:1.5;border-left:4px solid #b00020}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:16px 0 8px}.section-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#4a3c31;margin:0;font-size:16px;font-weight:500}.stack-trace-container[_ngcontent-%COMP%], .request-response-container[_ngcontent-%COMP%]{margin:16px 0}.stack-trace[_ngcontent-%COMP%], .code-block[_ngcontent-%COMP%]{padding:12px;background-color:#2d2d2d;color:#f8f8f2;border-radius:4px;overflow-x:auto;font-family:Courier New,Courier,monospace;font-size:13px;line-height:1.5;max-height:400px;white-space:pre-wrap}.headers-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:12px}.headers-container[_ngcontent-%COMP%]   .header-item[_ngcontent-%COMP%]{padding:8px 12px;background-color:#00000005;border-radius:4px}.headers-container[_ngcontent-%COMP%]   .header-item[_ngcontent-%COMP%]   .header-name[_ngcontent-%COMP%]{font-size:12px;color:#9e9e9e;margin-bottom:4px;font-weight:500}.headers-container[_ngcontent-%COMP%]   .header-item[_ngcontent-%COMP%]   .header-value[_ngcontent-%COMP%]{font-size:14px;color:#333;word-break:break-all}.not-found-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;text-align:center}.not-found-container[_ngcontent-%COMP%]   .not-found-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#b00020;margin-bottom:24px}.not-found-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#4a3c31;margin-bottom:12px}.not-found-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#9e9e9e;margin-bottom:24px;max-width:400px}mat-divider[_ngcontent-%COMP%]{margin:24px 0}"]})};export{de as ErrorLogDetailsComponent};
